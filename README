Borrowed from kmud's framework.
Great thanks to his excellent work!
